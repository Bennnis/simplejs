<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Base</title>
    <script src="../../dist/bundle.js"></script>
</head>
<body>
<div id="app"></div>
<script>
	Simple.directive('if', () => {
		let parentNode
		let cacheDom = document.createTextNode('')

		return {
			insert: (el, value) => {
				parentNode = el.parentNode
				if (!value) {
					parentNode.replaceChild(cacheDom, el)
				}
			},

			update: (el, value) => {
				if (value) {
					parentNode.replaceChild(el, cacheDom)
				} else {
					parentNode.replaceChild(cacheDom, el)
				}
			}
		}
	})

	const Component_2 = new Simple({
		state: {
			name: 'Simple Js',
			count: 1,
		},

		render: function (h) {
			return h('div', {
				props: {
					name: 'state name is true'
				}
			}, [
				h('p', {
					directives: [
						{
							key: 'if',
							condition: this.props.ifShow
						}
					]
				}, ['hello']),
				`if show : ${this.props.ifShow} ${this.state.count}`
			])
		}
	})

	const Component_1 = new Simple({
		state: {
			name: 'Simple Js',
			ifShow: false,
			count: 1,
		},

		render: function (h) {
			return h('div', {
				props: {
					name: 'state name is true'
				}
			}, [
				h(Component_2, {
					props: {
						ifShow: this.state.ifShow
					}
				}),
				`if show : ${this.state.ifShow} ${this.state.count}`,
				h('p', {}, ['static not update'])
			])
		},

		mounted() {
			setInterval(() => {
				this.setState({
					ifShow: !this.state.ifShow,
					count: this.state.count + 1
				})
			}, 1000)
		}
	})

	Simple.mount('#app', Component_1)
</script>
</body>
</html>